---
output:
  html_document: 
    keep_md: yes
    toc: yes
  pdf_document: default
---
# Sales Data for Staten Island
Thangam, Preeti, Ekaterina  
March 1, 2017  

####Here are some meaningful patterns in the dataset:
#####1.	50% of the sale prices are between 37100 and 585000 as indicated by the boxplot
#####2.	50% of the gross square footage is between 1242 and 2150 as indicated by the boxplot
#####3.	Most of the properties are less than 50000 in gross sqft with a few properties greater than 50000 in gross sqft.
#####4.	Only 2140 are 1,2,3 family homes as given by the dim(bk) command. The rest are other types of properties like land, apartments and other types.
#####5.There is moderate positive correlation between sales price and gross square footage as indicated by correlation coefficient. Which is expected as different building types were used for analysis.
#####6.The ratio of price to square footage is normally distributed as it's seen on a normal qq-plot.
#####7.Most of the sale prices is before 1 million and most of the gross square footage is less than 5000 sqft.
#####8. We specifically looked at 1,2,3 family homes. They shows correlation between sale price and square footage

```{r}
library(ggplot2)
library(sm)
```


```{r}
library(scales)
#upload clean dataset
dataset <- read.csv("CleanedSalesData.csv",header=TRUE)
summary(dataset)
```


```{r}
#plot sale price vs sqft

ggplot(dataset) + geom_point(data=dataset,aes(x=sale.price.n,
                                              y=gross.sqft), fill="DarkRed", shape=21)+scale_x_continuous(labels = comma)+scale_y_continuous(labels=comma)
```

```{r}
#correlation coefficient
cor(dataset$gross.sqft,dataset$sale.price.n)
```

```{r}
#reduced dataset. To see data claster closer
newset=subset(dataset,dataset$sale.price.n<1400000)
ggplot(dataset) + geom_point(data=newset,aes(x=sale.price.n,
                                             y=gross.sqft), fill="DarkRed", shape=21)+scale_x_continuous(labels = comma)+scale_y_continuous(labels = comma)
```

```{r}
#correlation coeficcient realy sensitive to outliers
cor(newset$gross.sqft,newset$sale.price.n)
```


```{r}
#boxplots
options(scipen=10000)
boxplot(dataset$gross.sqft,outline=FALSE,col="DarkRed", names="SQFT")
```


```{r}
boxplot(dataset$sale.price.n,outline=FALSE,col="DarkRed",names="Sale price")
```

```{r}
#qqplot of price to sqft
qqplot(x=dataset$sale.price.n,y=dataset$gross.sqft,col=rainbow(20))
```

```{r}
#normal qqplot for ratio price to sqft
qqnorm(dataset$cs.pricePERsqft,col="Orange")
qqline(dataset$cs.pricePERsqft,col="Blue")
```


```{r}
#hist with density curve Taken from http://www.statmethods.net/graphs/density.html
#because outlier drags to a high right scew logarithmic transformation was used
param.sale=log(dataset$sale.price.n)
h<-hist(param.sale, breaks=10, col="darkred", xlab="Sales Price", 
        main="Histogram with Normal Curve") 
xfit<-seq(min(param.sale),max(param.sale),length=40) 
yfit<-dnorm(xfit,mean=mean(param.sale),sd=sd(param.sale)) 
yfit <- yfit*diff(h$mids[1:2])*length(param.sale) 
lines(xfit, yfit, col="darkorchid3", lwd=2)
```

```{r}
#because outlier drags to a high right scew logarithmic transformation was used
param.gross=log(dataset$gross.sqft)
h<-hist(param.gross, breaks=10, col="maroon2", xlab="Gross SQFT", 
        main="Histogram with Normal Curve") 
xfit<-seq(min(param.gross),max(param.gross),length=40) 
yfit<-dnorm(xfit,mean=mean(param.gross),sd=sd(param.gross)) 
yfit <- yfit*diff(h$mids[1:2])*length(param.gross) 
lines(xfit, yfit, col="yellowgreen", lwd=2)
```


```{r}
#histogram with density curve for ratio price to sqft
#there is not need in logarithmic transformation
param.PriceSQFT=dataset$cs.pricePERsqft
h<-hist(param.PriceSQFT, breaks=10, col="orangered2", xlab="Ratio price to sqft", 
        main="Histogram with Normal Curve") 
xfit<-seq(min(param.PriceSQFT),max(param.PriceSQFT),length=40) 
yfit<-dnorm(xfit,mean=mean(param.PriceSQFT),sd=sd(param.PriceSQFT)) 
yfit <- yfit*diff(h$mids[1:2])*length(param.PriceSQFT) 
lines(xfit, yfit, col="lightslateblue", lwd=2)
```

```{r}
#Cpecifically looking at 1-, 2-, and 3-family homes
dataset.homes <- dataset[which(grepl("FAMILY",dataset$building.class.category)),]
dim(dataset.homes)
#Plot with log transformation base 10. Which produces normaly distributed data
plot(log10(dataset.homes$gross.sqft),log10(dataset.homes$sale.price.n))
#Summary of houses with sale price less than 122000
summary(dataset.homes[which(dataset.homes$sale.price.n<1000000),])
#Plot without log transformation which shows right scewed data for both variables
plot(dataset.homes$gross.sqft,dataset.homes$sale.price.n)
```
